Core moules ( includes those not requiriing require keword, Global modules)
NPM (Third party modules)
Custom modules

NPM means you can download modules, you can upload modules and also NPM is also a website. When NodeJS is insalled, NPM is also installed.

Most calls are async in nodejs.
Ways of running nodejs
	(a) node A.js  --- > Package.json is not used
	(b) npm run A.js
	(c) nodemon A.js
Node JS core APIs
=======================
https://nodejs.org/dist/latest-v6.x/docs/api/console.html
Note:-- The above is for 6.X series

Node JS third party APIs
=======================
You can search for the package in https://www.npmjs.com/. Search for that in the textbox 'find packages'.
Once you install it, go to the node_modules/<module_name>/README.md file. 
That file api-doc/documentation API links
TODO:-- May be there is a single site where all the 3rd party module APIs are hosted 



GIT (1st time)
========================
git init
git add -A
git commit -am "comment"  // This commits all added and modified files
git config --global user.name "sujithbabu1971" // May be there is a better way to force username
git config --global user.email "sujithkp@yahoo.com" // May be there is a better way to force username
git remote add ExpressJSSamples https://github.com/sujithbabu1971/ExpressJSSamples.git
git push -u  ExpressJSSamples // -u sets the files for pull also. This is important

GIT . Committing a modified file after the 1st time.
========================
git add filename
git commit -m "message" filename
git push 
Note:-- Only adding the file and committing worked for me. May be, there is a better way such as just commit. (Note:-- Later found that if we use -u in git push the 1st time, this step is not needed).



Install express
express-handlebars
express-session
body-parser


With -g (global installation), the --save option that saves into the package.json file does not seem to be working


For express-generator
=====================
First install express-generator globally. We do not need this as a dependancy to the project for obvious reasons.
Then "express myapp". This will create myapp with all the required directory structire. jade is the default template
"express --ejs myapp"  --> The template engine become ejs
"express --hbs myapp"  --> The template engine become handlebars
Fiddle around with these options to understand all that are available. 
Then cd to myapp directory
npm install ---> this will install all dependancies
npm start --> default start command in package.json. This has the start scripts in the ./bin/www folder that was created by express command.

YSLOW
=====================

JADE template
==============
No need to close html tags
Use either whitesapce or tab for indentation (Cant mix)
Even if you do not use it, div tag is assumed as the 1st element.
# is for id attribute and . is for class attribute.
Use html2jade for html to jade code conversion. Not all may be converted well. For an example, take care of the varaibles after the conversion.
To include text, just input it after the the tag. Eg: h1 I am good ===>  <h1> I am good</h1>
<input type+"text" placeholder="Username"/> in html ===> input(type="text",placeholder=="UserName")
To access a varaiblename value use =
eg:-- title=name . In this html <title> gets filled with the value from the name varaible.
to inject java scrript use -. (In ejs it was <% %> like in JSP)

When userName is a variable
the following would not work
p.text-center Hello =userName
instead use 
p.text-center Hello 
              =userName
Global scope tip in java script
==============
If you use 
i=10; inside a function, then i is a global varaibale and not limited to that function. Avoid this to ensure the variables are not conflicting.
So use 
var i=10;


Debugging node js applications
===============================
Install nodeclipse. This installation is one where you open an eclipse empty workspace and then drag and drop an image.  Refer http://marketplace.eclipse.org/marketplace-client-intro?mpc_install=2566102 for details. This will simulate the Help--> install new software option in eclipse. 

After the installation, create/import project as Node.js Express project. 
Right click on the starting file (not the project directory) and select the 1st option (Node appication). Do not select the second option (Node.js application)
This will start the application on the default debug port of 5858.
After that the debugging, variable expressions are as in the case of Java (Not as user friendly since some of the options that we are used with java debugging may not work here.). To set the breakpoint left click on the  margin (not right click on margin as I am used to in java eclipse debugging).
How to debug video is available at http://www.nodeclipse.org/usage
Good MongoDB material
=======================
https://www.tutorialspoint.com/mongodb/

Mongo DB
===============
Table in RDBMS ==> Collections in Mongo DB.
database ==> database
tuple/row ==> document (this is a json document)
Mongodb is called a document database. 
It is a no fixed schema (means that there are tables do not need specific columns)

Mongo DB Installation and commands
===============
Install mongodb
Add the bin to path
create a folder for data . Use md <folder> for this
start db by  mongod --dbpath <above_folder>

Now to connect use mongo command (This is similar to sqlplus)
show dbs   ---> Shows all databases
use <dbname> -- Goes to that database. It will also create that db.
to shutdown the db server gracefully,	
	use admin  --> So that you are in admin database
	db.shutdownServer()
	exit  --> After the db is shutdown, use this

To see collections (//r to tables in RDBMS), 
	use dbname
	show collections
To see logs
	show log

To create/drop dtabase/collections
	use <dbname> --> This will swich to the db. If not existimg, it will create also.
	dropDatabase() will drop the current database
	db.createCollection('express-templates') --> This creates the express-templates collections
	To display the database when using "show dbs", at least one collection should be created in that database.
	// to drop use the following
	var mydb = db.getCollection('express-templates');
	mydb.drop();  --> db.dbname.collection_name.drop() is an alternate syntax
	// The above will return true if existing

To view all documents(rows) in the collection, do the following
	var mydb = db.getCollection('express-templates');
	mydb.find();
	can also do the following in mongo shell
	db.express-templates.find();
	To beautify the above use db.express-templates.find().pretty();
To view specific documents(rows) in the collection, do the following
	var mydb = db.getCollection('express-templates');
	mydb.find({"runs":6,"batsman":"Sunil Gavaskar"});  -->  This will find  records that has Sunil gavaskar as the batsman and runs=6
Insert, Delete. Update
=====================
var mydb = db.getCollection('cricket');
mydb.insert({'batsman': 'Tendulkar', 'score':6});  ---> db.collection_name.insert({YOUR_JSON}). This will create the collection also if it not pre-existing.
mydb.remove({'score':6}); ---> equivalent syntax is db.collection_name.remove({YOUR_JSON}).
mydb.update({'score':6,'batsman':'Tendulkar'},  {$set:{'score':10}},   {upsert:true,multi:true})  ---> Updates the score to 10P.--> equivalent syntax is db.collection_name.update({YOUR_JSON}).
Update has multiple options. The general synats is 
	db.collection.update(
	   < >,
	   <update>,
	   {
	     upsert: <boolean>,
	     multi: <boolean>,
	     writeConcern: <document>,
	     collation: <document>
	   }
	)
	Read them at 
	https://docs.mongodb.com/manual/reference/method/db.collection.update/

	Details OF update options such as *$SET, $UNSET etc are available at 

	https://docs.mongodb.com/manual/reference/operator/update-field/


MongoDB- Node JS interaction
=============================
(a) by native mongodb library --> Suppossed to be more powerful. npm install mongodb
(b) by mongoose library --npm install mongoose
mongodb://localhost/cricket --> did not connect. Had to use mongodb://127.0.0.1/cricket
npm init is always needed first before doing npm install. Otherwise, the node_modules would not be created.

Hazelcast is the default caching mechanism with WSO2
======================================================

MongoDB namespace
======================
Search for https://docs.mongodb.com/manual/reference/glossary/ to understand what a namespace is

Db--> Collections --> Documents
=====================================

MongoDB query tutorials
==============================
https://docs.mongodb.com/manual/tutorial/query-documents/
What options can be used in find (query) are available at https://mongodb.github.io/node-mongodb-native/api-generated/collection.html#find
Native MongoDB Driver v/s Mongoose driver
===========================================
 MongoDB Driver is more powerful. 
 The advantage of Mongoose is that it is similar to an RDBMS driver. So programmers could be more familiar with it. It has SQL like syntax. Also, mongoose is better suited for fixed coulmns collections. Helps in validating the data. To do al these, we will need to write your own code in natoive mongod db. But it is provided out of the box in MongoDB.
 Mongoose allows you to define a schema (basically your collection structure ie; table definition).

 Mongoose API
 ==============
 The API is available at http://mongoosejs.com/docs/api.html
 It is not well organized. Read it carefully along with sample programs to understand fully well.

GROUP BY SYNTAX in MONGODB
=============================
Find the group by syntax in mongodb at 
http://mongodb.github.io/node-mongodb-native/2.2/api/Collection.html



Validation on Insert
=========================
To understand how to do validation on insert, Refer the program mongooseaddrecordwithvalidation.js.
Pay attention to the syntax of the callback function validate and also to the syntax err.errors.runs.message

Adobe Connect - Moxtra selection
==================================

WYSWYG selection
==================
TinyMCE  --> Existing
tkWWW etc
Fond list of wyswyg editors at https://en.wikipedia.org/wiki/List_of_HTML_editors
https://textbox.io/  
Also explored webdav (It uses HTTP PUT)

ETL v/s ESB
==============
ETL ---> Talend, Pentaho. Talend also have esb capabilties.
ESB ------> WSO2. Apache synapse, Apache camel, Apache ServiceMix, MULE
Apache ServiceMix is based on Apache Camel.
WSO2's esb engine is Apache synapse.

Name of our project can not be the same as the modules that we are going to install
=====================================================================================
font-awesome
===================
 http://fontawesome.io/ has has got beautiful font and css
 Use https://www.tutorialspoint.com/web_icons/ for font-awesome tutorials

 
 XHR
 ===========
XHR is simple old  XMLHttpRequest on which ajax calls are based on.
XMLHttpRequest (XHR) is an API that can be used by JavaScript, JScript, VBScript, and other web browser scripting languages to transfer and manipulate XML data to and from a webserver using HTTP, establishing an independent connection channel between a webpage's Client-Side and Server-Side

Node JS with rest end points
================================
If we are just using Node JS for rest APIs, then instead of 
response.render("PageName", {json object}); 
do the following
response.json({json object})

Node JS Gaps as compared with the established Java/J2EE web based technolgies
==============================================================================
(a) Connection pooling
(b) How does I18n work ?
(c) Log levels as in log4j/commons logger. Chalk gives only colour coding to the extendt that I am aware of it. It does not provide file based loggers that we would need for debugging production issues. It does not provide log level based logging as far as I am aware of it.

pre method
==================
pre method on let us say save, will call the pre method and only then call the save method.
The syntax for pre method is something like
pre('originalMethodName', function(next) {
	// Based on logic call next() which will call the actual method.
}
This synatx helps a lot in validate methods.


The greatest purpose of package.json is to ensure that the copy of the dependancy libraries are not copied from github to the deployment (heroku) environment. The deployment environment like heroku already has copies of that. However the question that I have is, what happens in case of a version conflict ? is such a version conflict possible at all as the dependacies mentioned in the package.json also.

Unlike import in JAVA, the require in node js should be in the same order as they are called. 
===============================================================================================
Eg:-- If module a is used before module b, then require(module a) should appear earlier than require(module b)
Session, bodyparser, static, template engines(???) are all middlewares in node js concepts.
===============================================================================================

Difference between Module and package
==================================================================
https://docs.npmjs.com/how-npm-works/packages

Express-session options
==========================
 Refer https:www.npmjs.com/package/express-session-expire-timeout for various session option . The session timeout default seems to be infinity.
 cookie: { secure: true } also below would set secure flag on the cookie. But for this  to work, https is needed. 
 app.use(session({"secret":"secret", "resave":"true", "saveUninitialized":"true"})); //deprecated

 method-override NPM package
 ==============================
Lets you use HTTP verbs such as PUT or DELETE in places where the client doesn't support it.
https://www.npmjs.com/package/method-override
Express error handling 400 and 500 series errors and other errors
==================================================================
http://expressjs.com/en/guide/error-handling.html
All details are in that link. 
res.status(500).send(); ===> Sends 500 error

PRE & POST Methods
========================
Mongoose schema has pre and post methods that can be called before let us say, save method of a model.
The details are available in the mongoose API at 
http://mongoosejs.com/docs/api.html#schema_Schema
A typical use would be to hash a password before saving it. Code sample is available in the db.js of leave-the-marks-master project in the Day 5 code.

MongoLabs (MLabs), MongoImport and MongoExport
=========================================
MLabs URL to login ---> https://mlab.com/login/
username:-- sujithbabu
Password: Power@30
DB Name that is created : sujith
DB user name: sujithuser
DN Password: sujithpassword
	To connect using the mongo shell:
		mongo ds157500.mlab.com:57500/sujith -u sujithuser -p sujithpassword

	To connect using a driver via the standard MongoDB URI (what's this?):
		mongodb://sujithuser:sujithpassword@ds157500.mlab.com:57500/sujith

To import the collection named cricketScores from local database named cricket to the file 'cricketScores.json', use the following command (NOT in Mongo shell. This has to be done in regular command prompt)
mongoexport --db cricket --collection cricketScores --out cricketScores.json

Now you can import to the remote cloud database like the below (Again, NOT in Mongo shell. This has to be done in regular command prompt)

mongoimport -h ds157500.mlab.com:57500 -d sujith -c cricketScores -u sujithuser -p sujithpassword --file cricketScores.json
The above will create the collection cricketScores if it not already present in the database. If already present, that will be reused.

mongoexport, mongoimport command detailss are available at https://docs.mongodb.com/manual/reference/program/. Click on MongoDB Package Components link on the left panel.  
Details are also available on MLabs after login on the 'Tools' tab.

Apache Kafka v/s Rabbit MQ v/s Active MQ v/s Open JMS
=======================================================
We chose Rabbit MQ for our product (agConnect) since it has some indirect way of fully supporting secured multi-tenancy where tenant data is not mixed-up. They use vhosts (same as in apache web server) for this.

Web Socket is a specification in HTML 5. Socket.io is an implementation of it in Node Js. WS.io, engine.io are other implemenations of web socket html5 specification in node.js 
============================================================================

HttpServer core module API v/s Express third party API v/s Sockets.io API
============================================================================
It is either express or http server in node js generally. We use express because it is more powerful (similar to JSP in J2ee terms), whereas http server is similar to servlets and not so poweful. For this reason, in general, we use the third party express package and not the httpServer APIs that are core modules of node.js. But for sockets.io APIs, we need httpServer even when we use express.

Socket.io
===================
In web sockets, there is a server socket and a client socket. The connected method(event) is on the server socket side. But the disconnect and chat-message are on the client socket. Note that while connected and disconnected are standard API events, chat-message is our own custom event name and the name can be anything.
io.emit() in server code emits message to all the clients. socket.emit() emits message to only that socket.
scoekt.on is an event.
socket.emit is a method.


STATIC middleware details
===========================
// This folder is the one from the static files are served. 
// By default, the index.html is the index file
app.use(exp.static(__dirname+ "/public"));

By default the index.html is the index file. So / will match this index.html
Web Sockets good material
===============================
https://os.alfajango.com/websockets-slides/#/

connection and disconnect are the events in Socket.io
==========================================================

Sockets.io ---> How to create separate rooms for chats
==========================================================
Use Namespaces for the same.
Socket.IO allows you to “namespace” your sockets, which essentially means assigning different endpoints or paths.
Refer the API https://socket.io/docs/rooms-and-namespaces/ for that. It has join method. There does not seem to be any explicit leave method as disconnect event seems to be enough.

Events in node.js
=====================
Events is a core module.
The core API is https://nodejs.org/dist/latest-v6.x/docs/api/events.html
EventEmitter is the base module. All methods on this is available at https://nodejs.org/dist/latest-v6.x/docs/api/events.html
Obviously sockets.io extends from events module if we can compare this with JAVA.
Sample code is as below. 

		const EventEmitter = require('events');

		class MyEmitter extends EventEmitter {}

		const myEmitter = new MyEmitter();
		// on is the key word.
		myEmitter.on('event name', () => {
		  console.log('an event occurred!');
		});
		myEmitter.emit('event name');


		Asynchronous vs. Synchronous#
			The EventListener calls all listeners synchronously in the order in which they were registered. This is important to ensure the proper sequencing of events and to avoid race conditions or logic errors. When appropriate, listener functions can switch to an asynchronous mode of operation using the setImmediate() or process.nextTick() methods:

		const myEmitter = new MyEmitter();
		myEmitter.on('event', (a, b) => {
		  setImmediate(() => {
		    console.log('this happens asynchronously');
		  });
		});
		myEmitter.emit('event', 'a', 'b');
		
		Handling events only once#
		When a listener is registered using the eventEmitter.on() method, that listener will be invoked every time the named event is emitted.

		const myEmitter = new MyEmitter();
		let m = 0;
		myEmitter.on('event', () => {
		  console.log(++m);
		});
		myEmitter.emit('event');
		// Prints: 1
		myEmitter.emit('event');
		// Prints: 2
		Using the eventEmitter.once() method, it is possible to register a listener that is called at most once for a particular event. Once the event is emitted, the listener is unregistered and then called.

		const myEmitter = new MyEmitter();
		let m = 0;
		myEmitter.once('event', () => {
		  console.log(++m);
		});
		myEmitter.emit('event');
		// Prints: 1
		myEmitter.emit('event');
		// Ignored

WebRTC
==================
WebRTC ("Web Real-Time Communication") is a collection of communications protocols and application programming interfaces that enable real-time communication over peer-to-peer connections. This allows web browsers to not only request resources from backend servers, but also real-time information from browsers of other users.

This enables applications such as video conferencing, file transfer, chat, or desktop sharing without the need of either internal or external plugins.[1]


The idea in Sockets.io is to EMIT from client and server handling that with ON. During this ON processing, the server will EMIT and the client will have to handle with ON. You just need to understand this and get the programming cycle right. 


GRUNT, GULP Tools
==================
For GRUNT refer https://gruntjs.com/ This is the official material.
GULP is in memory while GRUNT creates temporary files. So obviously GULP is faster.
Also GULP has piping feature.
GULP is asynchronous in nature with node js synatx. GRUNT is more like a configuration language.
GULP is overtaking GRUNT, 
GULP has many plugins for reactjs, angular js etc https://gulpjs.com/plugins/


Install GRUN/GULP in dev dependancy mode
========================================================================
npm install grunt --save-dev  --> For grunt command. Set path to the bin under <<>Installation_Directory>\node_modules\grunt\bin.
It is better to install all grunt and gulp related packages with global scope as they are just development dependancies.
This will install "devDependencies": {
    "grunt": "^1.0.1"
  }

Other synatx variations like does not install grunt/gulp as dep dependancy only.

Also install npm install grunt-contrib-cssmin --save-dev --> For minification of css script
Provide Gruntfile.js / gulpfile.js. (Case sensitive)
npm install grunt-contrib-uglify --save-dev  --> For minification of java script. This also does code mangling. (Same thing that we used in applet code long time back whereby variable names are shortened.). To avoid the mangling so that we can read the code better, use mangle:false. By default mangle is true in both GRUNT and GULP (I have verified this with hands-on exercise in both GRUNT and GULP).


Also install npm install grunt-contrib-watch --save-dev ---> This is to ensure minification after each edit without having to run the grunt minify task again.
combine in css-min and jscript files mean minifying first and then combining
GULP
============
https://gulpjs.com/ is the official material
npm install gulp --save-dev   ----> GULP
npm install gulp-cssnano --save-dev ----> GULP css minification
npm install gulp-concat --save-dev ----> GULP file joining (both css and java script)
npm install gulp-uglify --save-dev ----> GULP file joining (both css and java script)
Watch is also supported in GULP. But it does not need another installable unlike GRUNT.

In GULP, the task names can be anything unlike GRUNT where it was alwyas fixed. For an example, I tried to change the uglify name to uglifyWithAnotherSyntax in gGRUNT and it did not work.But in GULP this worked.
Here also, please mangle option is to be set to false to avoid variable renaming.
GULP syntax is similar to node js synatx.
GULP has many plugins for reactjs, angular js etc https://gulpjs.com/plugins/

Watch out for the version difference between the GULP global version that provides GULP command and the local GULP version that is instaled in the node_modules of the project 

Java_Code_Coverage_Tools
=========================
Cobertura

Browser can download only two files at a time
==============================================

GRUNT is more like a configuration language. But GULP is an asynchronous node js code.
========================================================================================
Linting is a generic term for finding out issues in code. Refer https://en.wikipedia.org/wiki/Lint_%28software%29 . But in java script terminology, it seems to mean verifying potential syntax error during build stage itself since otherwise an intrepreted language like java script will check it only at the runtime.

To update npm itelf
======================
To update npm itelf use
npm update -g npm

Difference between Grunt-cli and grunt
=======================================
cli stands for command line. It seems to install the command, but for it to work correctly grunt also should be installed. This seems to be the difference. The details are available at https://gruntjs.com/getting-started. However, on first reading the difference is not very clear.
The above mechanism allows GRUNT version to be different for each project. Same is the case for GULP. It seems to insist on using the GRUNT in the local node_modules directory always and not the ones installed globally.
GULP uses streams
====================

FS Module in Node JS is similar to IO package in JAVA
=======================================================
FS Module in Node JS is similar to IO package in JAVA

WATCH in both GRUNT and GULP takes effect only after changing contents. It does not run the 1st time. This is the default behaviour at least.
================================================================================================================================================
May be there are options to change them.
=========================================================